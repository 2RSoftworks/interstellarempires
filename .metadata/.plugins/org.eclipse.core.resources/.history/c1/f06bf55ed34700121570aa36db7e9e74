package bucket.game.client.core;

import com.badlogic.gdx.ApplicationListener;
import com.badlogic.gdx.Files.FileType;
import com.badlogic.gdx.Gdx;
import com.badlogic.gdx.graphics.GL10;
import com.badlogic.gdx.graphics.g2d.SpriteBatch;
import com.badlogic.gdx.twl.Layout;
import com.badlogic.gdx.twl.TWL;

import de.matthiasmann.twl.Button;
import de.matthiasmann.twl.TextArea;
import de.matthiasmann.twl.textarea.SimpleTextAreaModel;

public class PlayingWithTWL implements ApplicationListener {
	private TWL twl;
	private SpriteBatch spriteBatch;
	private int clicks;

	private SimpleTextAreaModel clickText;

	@Override
	public void create() {
		spriteBatch = new SpriteBatch();

		SimpleTextAreaModel mainText = new SimpleTextAreaModel();
		mainText.setText("Click the button to count. See how high you can go!");
		TextArea mainTextArea = new TextArea(mainText);

		clickText = new SimpleTextAreaModel();
		clickText.setText("0");
		TextArea clickCounter = new TextArea(clickText);

		Button clickButton = new Button();
		clickButton.setText("click me");

		clickButton.addCallback(new Runnable() {
			@Override
			public void run() {
				clicks++;
			}
		});

		Layout layout = new Layout();
		layout.horizontal().parallel(mainTextArea, clickCounter, clickButton);
		layout.vertical().sequence(mainTextArea, 5, clickCounter, 5,
				clickButton, 5);

		twl = new TWL(spriteBatch, "data/widgets.xml", FileType.Internal,
				layout);

		Gdx.input.setInputProcessor(twl);

		clicks = 0;
	}

	@Override
	public void resume() {
	}

	@Override
	public void render() {
		Gdx.gl.glClear(GL10.GL_COLOR_BUFFER_BIT);

		clickText.setText(clicks + "");

		twl.render();

		try {
			Thread.sleep(16); // ~60FPS
		} catch (InterruptedException e) {
		}
	}

	@Override
	public void resize(int width, int height) {
	}

	@Override
	public void pause() {
	}

	@Override
	public void dispose() {
		spriteBatch.dispose();
		twl.dispose();
	}
}
